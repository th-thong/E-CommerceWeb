openapi: 3.0.3
info:
  title: ''
  version: 0.0.0
paths:
  /api/auth/forgot-password/:
    post:
      operationId: api_auth_forgot_password_create
      description: Người dùng nhập Email. Hệ thống sẽ kiểm tra và gửi mã OTP (6 số)
        về email nếu tồn tại. OTP có hiệu lực 5 phút.
      summary: Quên mật khẩu (Gửi OTP)
      tags:
      - Auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
        required: true
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForgotPasswordSuccess'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForgotPasswordError'
          description: ''
        '500':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailServiceError'
          description: ''
  /api/auth/login/:
    post:
      operationId: api_auth_login_create
      summary: Đăng nhập
      tags:
      - Auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/LoginRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginSuccessResponse'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginFailResponse'
          description: ''
  /api/auth/refresh/:
    post:
      operationId: api_auth_refresh_create
      description: |-
        Takes a refresh type JSON web token and returns an access type JSON web
        token if the refresh token is valid.
      tags:
      - api
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRefresh'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenRefresh'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/TokenRefresh'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenRefresh'
          description: ''
  /api/auth/register/:
    post:
      operationId: api_auth_register_create
      summary: Đăng kí tài khoản
      tags:
      - Auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRegister'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/UserRegister'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UserRegister'
        required: true
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterSuccessResponse'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterFailResponse'
          description: ''
  /api/auth/reset-password/:
    post:
      operationId: api_auth_reset_password_create
      description: Người dùng gửi Email + OTP + Mật khẩu mới. Hệ thống kiểm tra OTP
        trong Cache, nếu đúng sẽ đổi mật khẩu.
      summary: Xác thực OTP & Đổi mật khẩu
      tags:
      - Auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ResetPasswordRequest'
        required: true
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResetPasswordSuccess'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResetPasswordError'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotFoundReset'
          description: ''
  /api/categories/:
    get:
      operationId: api_categories_list
      description: API trả về toàn bộ danh mục sản phẩm có trong hệ thống.
      summary: Lấy danh sách danh mục
      tags:
      - Category
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
          description: ''
  /api/feedback/{product_id}/:
    get:
      operationId: api_feedback_list
      description: Lấy danh sách các đánh giá đã được duyệt (status='normal') của
        một sản phẩm cụ thể.
      summary: Xem danh sách đánh giá
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        description: ID của sản phẩm cần xem đánh giá
        required: true
      tags:
      - Feedback
      security:
      - jwtAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Feedback'
          description: ''
    post:
      operationId: api_feedback_create
      description: Người dùng (đã đăng nhập) gửi đánh giá và nhận xét cho sản phẩm.
      summary: Gửi đánh giá mới
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        description: ID của sản phẩm muốn đánh giá
        required: true
      tags:
      - Feedback
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewFeedback'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/NewFeedback'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/NewFeedback'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackSuccess'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackError'
          description: ''
  /api/feedback/{product_id}/{feedback_id}/:
    get:
      operationId: api_feedback_retrieve
      parameters:
      - in: path
        name: feedback_id
        schema:
          type: integer
        required: true
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - api
      security:
      - jwtAuth: []
      responses:
        '200':
          description: No response body
    post:
      operationId: api_feedback_create_2
      parameters:
      - in: path
        name: feedback_id
        schema:
          type: integer
        required: true
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - api
      security:
      - jwtAuth: []
      responses:
        '200':
          description: No response body
  /api/orders/:
    get:
      operationId: api_orders_list
      description: Trả về danh sách chi tiết các đơn hàng mà user hiện tại đã mua
        (bao gồm cả trạng thái và sản phẩm bên trong).
      summary: Lấy lịch sử mua hàng
      tags:
      - Order
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OrderHistory'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NoOrderFound'
          description: ''
    post:
      operationId: api_orders_create
      description: User gửi danh sách sản phẩm để tạo đơn. Hỗ trợ thanh toán COD và
        VNPAY.
      summary: Tạo đơn hàng mới
      tags:
      - Order
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewOrder'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/NewOrder'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/NewOrder'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VNPAYResponse'
          description: ''
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CODResponse'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderCreateError'
          description: ''
  /api/orders/{order_id}/:
    get:
      operationId: api_orders_retrieve
      description: Lấy thông tin chi tiết một đơn hàng cụ thể. Chỉ chủ sở hữu đơn
        hàng mới xem được.
      summary: Xem chi tiết đơn hàng
      parameters:
      - in: path
        name: order_id
        schema:
          type: integer
        description: ID của đơn hàng cần xem
        required: true
      tags:
      - Order
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderNotFound'
          description: ''
        '500':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderSystemError'
          description: ''
  /api/orders/my-shop/:
    get:
      operationId: api_orders_my_shop_list
      description: Dành cho người bán. Trả về danh sách các sản phẩm mà khách đã đặt
        từ Shop của bạn.
      summary: Lấy đơn hàng của Shop (Kênh người bán)
      tags:
      - Order
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ShopOrderDetail'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopNotFound'
          description: ''
        '500':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopSystemError'
          description: ''
  /api/payment/cod/:
    post:
      operationId: api_payment_cod_create
      description: Xác nhận phương thức thanh toán khi nhận hàng (Cash On Delivery).
        Hệ thống sẽ chuyển trạng thái thanh toán của các sản phẩm trong đơn hàng sang
        'Pending'.
      summary: Xác nhận thanh toán COD
      tags:
      - Payment
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CODSerializers'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CODSerializers'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CODSerializers'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CODSuccessResponse'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CODErrorResponse'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CODNotFoundResponse'
          description: ''
  /api/payment/vnpay/query/:
    post:
      operationId: api_payment_vnpay_query_create
      description: Chủ động hỏi VNPAY xem giao dịch này đã thành công chưa (Dùng để
        đối soát hoặc khi IPN bị lỗi).
      summary: Truy vấn trạng thái giao dịch (QueryDR)
      tags:
      - Payment
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VNPAYQueryRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/VNPAYQueryRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/VNPAYQueryRequest'
        required: true
      security:
      - cookieAuth: []
      - basicAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/payment/vnpay/return/:
    get:
      operationId: api_payment_vnpay_return_retrieve
      description: Frontend gọi API này sau khi user được redirect từ VNPAY về, để
        xác thực lại checksum và hiển thị kết quả.
      summary: VNPAY Return URL
      parameters:
      - in: query
        name: vnp_ResponseCode
        schema:
          type: string
        description: '00: Thành công'
      - in: query
        name: vnp_SecureHash
        schema:
          type: string
        description: Checksum
      - in: query
        name: vnp_TxnRef
        schema:
          type: string
        description: Mã đơn hàng
      tags:
      - Payment
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReturnSuccess'
          description: ''
  /api/payment/vnpay_ipn/:
    get:
      operationId: api_payment_vnpay_ipn_retrieve
      description: API này chỉ dành cho Server VNPAY gọi tự động để cập nhật trạng
        thái đơn hàng (Pending -> Paid). Người dùng không gọi trực tiếp.
      summary: IPN (Webhook từ VNPAY)
      parameters:
      - in: query
        name: vnp_Amount
        schema:
          type: string
        description: Số tiền (đã nhân 100)
        required: true
      - in: query
        name: vnp_ResponseCode
        schema:
          type: string
        description: Mã phản hồi (00 là thành công)
        required: true
      - in: query
        name: vnp_SecureHash
        schema:
          type: string
        description: Mã kiểm tra toàn vẹn
        required: true
      - in: query
        name: vnp_TxnRef
        schema:
          type: string
        description: Mã đơn hàng (Order ID)
        required: true
      tags:
      - Payment
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IPNResponse'
          description: ''
  /api/products/public/{product_id}/:
    get:
      operationId: api_products_public_retrieve
      description: Lấy thông tin chi tiết (bao gồm variants, images, shop) của một
        sản phẩm.
      summary: Xem chi tiết sản phẩm
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        description: ID của sản phẩm cần xem
        required: true
      tags:
      - Product
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductNotFound'
          description: ''
  /api/products/public/flash-sale/:
    get:
      operationId: api_products_public_flash_sale_list
      description: Lấy danh sách các sản phẩm đang giảm giá sâu (Discount >= 50%).
      summary: Sản phẩm Flash Sale
      tags:
      - Product
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
          description: ''
  /api/products/public/list/:
    get:
      operationId: api_products_public_list_list
      description: Trả về danh sách toàn bộ sản phẩm, sắp xếp mới nhất lên đầu.
      summary: Lấy danh sách tất cả sản phẩm
      tags:
      - Product
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
          description: ''
  /api/products/public/recommend/:
    get:
      operationId: api_products_public_recommend_list
      description: "\n    Gợi ý sản phẩm thông minh:\n    - **Đã đăng nhập:** Ưu tiên
        hiển thị sản phẩm thuộc Category mà User hay mua nhất.\n    - **Chưa đăng
        nhập:** Hiển thị sản phẩm mới nhất.\n    "
      summary: Gợi ý sản phẩm (Recommend)
      tags:
      - Product
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
          description: ''
  /api/products/public/trendy/:
    get:
      operationId: api_products_public_trendy_list
      description: Trả về danh sách 10 sản phẩm có số lượng bán cao nhất trong 7 ngày
        qua.
      summary: Top sản phẩm bán chạy (Trendy)
      tags:
      - Product
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
          description: ''
  /api/products/seller/my-products/:
    get:
      operationId: api_products_seller_my_products_list
      description: API dành cho người bán. Trả về tất cả sản phẩm thuộc Shop của User
        đang đăng nhập.
      summary: Lấy danh sách sản phẩm của Shop
      tags:
      - Product
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
          description: ''
    post:
      operationId: api_products_seller_my_products_create
      description: 'Người bán tạo sản phẩm mới kèm theo Variants và Images (Hỗ trợ
        Multipart/Form-data). Với , variant là 1 list gồm {"price": 150000,"quantity":
        50,"attributes": {"color": "White", "type": "S"}, các trường attributes là
        người dùng nhập'
      summary: Tạo sản phẩm mới
      tags:
      - Product
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Product'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Product'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Product'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductCreateError'
          description: ''
        '403':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopError'
          description: ''
  /api/products/seller/my-products/{product_id}/:
    get:
      operationId: api_products_seller_my_products_retrieve
      description: Người bán xem chi tiết một sản phẩm do mình tạo ra.
      summary: Xem chi tiết sản phẩm của Shop
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - Product
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SellerProductNotFound'
          description: ''
    put:
      operationId: api_products_seller_my_products_update
      description: Cập nhật thông tin sản phẩm (Partial update cho phép cập nhật từng
        trường).
      summary: Cập nhật sản phẩm
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - Product
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Product'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Product'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Product'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateError'
          description: ''
    delete:
      operationId: api_products_seller_my_products_destroy
      description: Xóa sản phẩm khỏi hệ thống (Chỉ chủ sở hữu mới xóa được).
      summary: Xóa sản phẩm
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - Product
      security:
      - jwtAuth: []
      responses:
        '204':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteSuccess'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteError'
          description: ''
  /api/schema/:
    get:
      operationId: api_schema_retrieve
      description: |-
        OpenApi3 schema for this API. Format can be selected via content negotiation.

        - YAML: application/vnd.oai.openapi
        - JSON: application/vnd.oai.openapi+json
      parameters:
      - in: query
        name: format
        schema:
          type: string
          enum:
          - json
          - yaml
      - in: query
        name: lang
        schema:
          type: string
          enum:
          - af
          - ar
          - ar-dz
          - ast
          - az
          - be
          - bg
          - bn
          - br
          - bs
          - ca
          - ckb
          - cs
          - cy
          - da
          - de
          - dsb
          - el
          - en
          - en-au
          - en-gb
          - eo
          - es
          - es-ar
          - es-co
          - es-mx
          - es-ni
          - es-ve
          - et
          - eu
          - fa
          - fi
          - fr
          - fy
          - ga
          - gd
          - gl
          - he
          - hi
          - hr
          - hsb
          - hu
          - hy
          - ia
          - id
          - ig
          - io
          - is
          - it
          - ja
          - ka
          - kab
          - kk
          - km
          - kn
          - ko
          - ky
          - lb
          - lt
          - lv
          - mk
          - ml
          - mn
          - mr
          - ms
          - my
          - nb
          - ne
          - nl
          - nn
          - os
          - pa
          - pl
          - pt
          - pt-br
          - ro
          - ru
          - sk
          - sl
          - sq
          - sr
          - sr-latn
          - sv
          - sw
          - ta
          - te
          - tg
          - th
          - tk
          - tr
          - tt
          - udm
          - ug
          - uk
          - ur
          - uz
          - vi
          - zh-hans
          - zh-hant
      tags:
      - api
      security:
      - cookieAuth: []
      - basicAuth: []
      - {}
      responses:
        '200':
          content:
            application/vnd.oai.openapi:
              schema:
                type: object
                additionalProperties: {}
            application/yaml:
              schema:
                type: object
                additionalProperties: {}
            application/vnd.oai.openapi+json:
              schema:
                type: object
                additionalProperties: {}
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/shops/my-shop/:
    get:
      operationId: api_shops_my_shop_retrieve
      description: Trả về thông tin chi tiết Shop của User đang đăng nhập.
      summary: Lấy thông tin Shop của tôi
      tags:
      - Shop
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopNotFound'
          description: ''
    post:
      operationId: api_shops_my_shop_create
      description: Đăng ký mở Shop bán hàng. Mỗi User chỉ được tạo duy nhất 1 Shop.
      summary: Đăng ký Shop mới
      tags:
      - Shop
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShopRegister'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ShopRegister'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ShopRegister'
        required: true
      security:
      - jwtAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopCreateSuccess'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopCreateError'
          description: ''
    put:
      operationId: api_shops_my_shop_update
      description: Cho phép User chỉnh sửa thông tin Shop (Tên, mô tả, địa chỉ...).
      summary: Cập nhật thông tin Shop
      tags:
      - Shop
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Shop'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Shop'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Shop'
        required: true
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopUpdateError'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShopNotFoundUpdate'
          description: ''
  /api/shops/my-shop/orders/{detail_id}/update/:
    patch:
      operationId: api_shops_my_shop_orders_update_partial_update
      description: Dành cho Shop. Cập nhật trạng thái xử lý (Pending -> Confirmed
        -> Shipped) hoặc thanh toán.
      summary: Cập nhật trạng thái đơn hàng
      parameters:
      - in: path
        name: detail_id
        schema:
          type: integer
        required: true
      tags:
      - Order (Seller)
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUpdateOrderStatus'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedUpdateOrderStatus'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedUpdateOrderStatus'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateStatusSuccess'
          description: ''
        '403':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Forbidden'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFound'
          description: ''
  /api/users/me/:
    get:
      operationId: api_users_me_retrieve
      description: Trả về thông tin chi tiết của người dùng đang đăng nhập dựa trên
        Token gửi kèm.
      summary: Lấy thông tin cá nhân (Profile)
      tags:
      - User
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
    put:
      operationId: api_users_me_update
      description: Cho phép cập nhật một phần thông tin (username,...). Chỉ cần gửi
        các trường muốn thay đổi.
      summary: Cập nhật thông tin cá nhân
      tags:
      - User
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/User'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/User'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateProfileError'
          description: ''
  /shopadmin/approve-feedback/{feedback_id}/:
    put:
      operationId: shopadmin_approve_feedback_update
      summary: Chấp thuận feedback
      parameters:
      - in: path
        name: feedback_id
        schema:
          type: integer
        description: ID của feedback
        required: true
      tags:
      - Admin - Feedback
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feedback'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApproveFeedbackError'
          description: ''
  /shopadmin/banned-feedback/{product_id}/:
    get:
      operationId: shopadmin_banned_feedback_list
      summary: Lấy danh sách các feedback bị cấm
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - Admin - Feedback
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Feedback'
          description: ''
  /shopadmin/pendingusers/:
    get:
      operationId: shopadmin_pendingusers_list
      summary: Lấy danh sách người dùng đang chờ duyệt thành người bán
      tags:
      - Admin - User
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
          description: ''
  /shopadmin/product-list/:
    get:
      operationId: shopadmin_product_list_list
      summary: Lấy danh sách sản phẩm chờ duyệt
      tags:
      - Admin - Product
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Product'
          description: ''
  /shopadmin/product/{product_id}/:
    get:
      operationId: shopadmin_product_retrieve
      summary: Lấy chi tiết sản phẩm chờ duyệt
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - Admin - Product
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          description: ''
    put:
      operationId: shopadmin_product_update
      summary: Duyệt sản phẩm
      parameters:
      - in: path
        name: product_id
        schema:
          type: integer
        required: true
      tags:
      - Admin - Product
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          description: ''
  /shopadmin/user/{user_id}/:
    get:
      operationId: shopadmin_user_retrieve
      summary: Lấy chi tiết một người dùng
      parameters:
      - in: path
        name: user_id
        schema:
          type: integer
        required: true
      tags:
      - Admin - User
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
    put:
      operationId: shopadmin_user_update
      summary: Cập nhật vai trò/trạng thái người dùng
      parameters:
      - in: path
        name: user_id
        schema:
          type: integer
        required: true
      tags:
      - Admin - User
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
    delete:
      operationId: shopadmin_user_destroy
      summary: Xóa một người dùng
      parameters:
      - in: path
        name: user_id
        schema:
          type: integer
        required: true
      tags:
      - Admin - User
      security:
      - jwtAuth: []
      responses:
        '204':
          description: No response body
  /shopadmin/users/:
    get:
      operationId: shopadmin_users_list
      summary: Lấy danh sách tất cả người dùng (customer)
      tags:
      - Admin - User
      security:
      - jwtAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
          description: ''
components:
  schemas:
    ApproveFeedbackError:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    CODErrorResponse:
      type: object
      properties:
        message:
          type: string
          default: Thanh toán COD không thành công
    CODNotFoundResponse:
      type: object
      properties:
        error:
          type: string
          default: Order not found
    CODResponse:
      type: object
      properties:
        message:
          type: string
        order_id:
          type: integer
        payment_type:
          type: string
          default: COD
        data:
          $ref: '#/components/schemas/Order'
      required:
      - data
      - message
      - order_id
    CODSerializers:
      type: object
      properties:
        order_id:
          type: string
          description: Mã đơn hàng unique
    CODSuccessResponse:
      type: object
      properties:
        message:
          type: string
          default: Thanh toán COD thành công
    Category:
      type: object
      properties:
        category_id:
          type: integer
        category_name:
          type: string
          maxLength: 45
      required:
      - category_id
      - category_name
    DeleteError:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    DeleteSuccess:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    EmailServiceError:
      type: object
      properties:
        error:
          type: string
          default: Error sending email...
    Feedback:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        rating:
          nullable: true
          minimum: -2147483648
          maximum: 2147483647
          oneOf:
          - $ref: '#/components/schemas/RatingEnum'
          - $ref: '#/components/schemas/NullEnum'
        review:
          type: string
        user_name:
          type: string
          readOnly: true
        user_id:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        items:
          type: array
          items:
            $ref: '#/components/schemas/Reply'
          readOnly: true
      required:
      - created_at
      - id
      - items
      - review
      - user_id
      - user_name
    FeedbackError:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    FeedbackSuccess:
      type: object
      properties:
        message:
          type: string
          default: Cảm ơn bạn! Đánh giá của bạn đã được gửi.
    Forbidden:
      type: object
      properties:
        detail:
          type: string
      required:
      - detail
    ForgotPasswordError:
      type: object
      properties:
        error:
          type: string
          default: Please enter email
    ForgotPasswordRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Nhập email tài khoản cần khôi phục
      required:
      - email
    ForgotPasswordSuccess:
      type: object
      properties:
        message:
          type: string
          default: OTP code has been sent to your email.
    IPNResponse:
      type: object
      properties:
        RspCode:
          type: string
        Message:
          type: string
      required:
      - Message
      - RspCode
    LoginFailResponse:
      type: object
      properties:
        error:
          type: string
          readOnly: true
          default: Fail to login
      required:
      - error
    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          default: example@gmail.com
        password:
          type: string
          writeOnly: true
          default: '12345678'
    LoginSuccessResponse:
      type: object
      properties:
        message:
          type: string
          readOnly: true
          default: Successfully login
      required:
      - message
    NewFeedback:
      type: object
      properties:
        rating:
          type: integer
          maximum: 5
          minimum: 1
        review:
          type: string
      required:
      - rating
      - review
    NewOrder:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/NewOrderDetail'
          writeOnly: true
        payment_type:
          allOf:
          - $ref: '#/components/schemas/PaymentTypeEnum'
          default: COD
        full_name:
          type: string
          nullable: true
          maxLength: 150
        phone_number:
          type: string
          nullable: true
          maxLength: 20
        address:
          type: string
        note:
          type: string
      required:
      - items
    NewOrderDetail:
      type: object
      properties:
        product_id:
          type: integer
        variant_id:
          type: integer
          nullable: true
        quantity:
          type: integer
          minimum: 1
      required:
      - product_id
      - quantity
    NoOrderFound:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    NotFound:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    NullEnum:
      enum:
      - null
    Order:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        user:
          type: integer
        total_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        created_at:
          type: string
          format: date-time
          readOnly: true
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderDetail'
          readOnly: true
        full_name:
          type: string
          nullable: true
          maxLength: 150
        phone_number:
          type: string
          nullable: true
          maxLength: 20
        address:
          type: string
        note:
          type: string
      required:
      - created_at
      - id
      - items
      - total_price
      - user
    OrderCreateError:
      type: object
      properties:
        message:
          type: string
        error_detail:
          type: string
      required:
      - error_detail
      - message
    OrderDetail:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        quantity:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        order:
          type: integer
        product:
          type: integer
        shop:
          type: integer
        order_status:
          $ref: '#/components/schemas/OrderStatusEnum'
        payment_status:
          $ref: '#/components/schemas/PaymentStatusEnum'
      required:
      - id
      - order
      - price
      - product
      - quantity
      - shop
    OrderHistory:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        total_price:
          type: string
        created_at:
          type: string
          format: date-time
          readOnly: true
        payment_method:
          type: string
          readOnly: true
        order_status:
          type: string
          description: Lấy trạng thái đại diện cho đơn hàng
          readOnly: true
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItem'
          readOnly: true
        full_name:
          type: string
          nullable: true
          maxLength: 150
        phone_number:
          type: string
          nullable: true
          maxLength: 20
        address:
          type: string
        note:
          type: string
      required:
      - created_at
      - id
      - items
      - order_status
      - payment_method
      - total_price
    OrderItem:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        product_id:
          type: integer
          readOnly: true
        product_name:
          type: string
          readOnly: true
        product_image:
          type: string
          readOnly: true
        variant:
          type: object
          additionalProperties: {}
          readOnly: true
        quantity:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        payment_status:
          $ref: '#/components/schemas/PaymentStatusEnum'
        order_status:
          $ref: '#/components/schemas/OrderStatusEnum'
      required:
      - id
      - price
      - product_id
      - product_image
      - product_name
      - quantity
      - variant
    OrderNotFound:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    OrderStatusEnum:
      enum:
      - pending
      - confirmed
      - shipped
      type: string
      description: |-
        * `pending` - Pending
        * `confirmed` - Confirmed
        * `shipped` - Shipped
    OrderSystemError:
      type: object
      properties:
        message:
          type: string
        details:
          type: string
      required:
      - details
      - message
    PatchedUpdateOrderStatus:
      type: object
      properties:
        order_status:
          $ref: '#/components/schemas/OrderStatusEnum'
        payment_status:
          $ref: '#/components/schemas/PaymentStatusEnum'
    PaymentStatusEnum:
      enum:
      - paid
      - pending
      type: string
      description: |-
        * `paid` - Paid
        * `pending` - Pending
    PaymentTypeEnum:
      enum:
      - COD
      - VNPAY
      type: string
      description: |-
        * `COD` - COD
        * `VNPAY` - VNPAY
    Product:
      type: object
      properties:
        product_id:
          type: integer
          readOnly: true
        product_name:
          type: string
          maxLength: 250
        description:
          type: string
        base_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
        discount:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        category:
          type: integer
        shop:
          allOf:
          - $ref: '#/components/schemas/Shop'
          readOnly: true
        is_active:
          type: boolean
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true
        images:
          type: array
          items:
            $ref: '#/components/schemas/ProductImage'
          readOnly: true
        variants:
          type: array
          items:
            $ref: '#/components/schemas/ProductVariant'
          readOnly: true
        uploaded_images:
          type: array
          items:
            type: string
          writeOnly: true
        variants_input:
          writeOnly: true
        images_to_delete:
          writeOnly: true
      required:
      - category
      - created_at
      - description
      - images
      - product_id
      - product_name
      - shop
      - updated_at
      - variants
    ProductCreateError:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    ProductImage:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        image_url:
          type: string
          readOnly: true
        file_id:
          type: string
          nullable: true
          maxLength: 255
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - id
      - image_url
    ProductNotFound:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    ProductVariant:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,10}(?:\.\d{0,2})?$
        quantity:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        attributes: {}
        is_active:
          type: boolean
      required:
      - id
      - price
    RatingEnum:
      enum:
      - 1
      - 2
      - 3
      - 4
      - 5
      type: integer
      description: |-
        * `1` - 1
        * `2` - 2
        * `3` - 3
        * `4` - 4
        * `5` - 5
    RegisterFailResponse:
      type: object
      properties:
        error:
          type: string
          readOnly: true
          default: Fail to create account
      required:
      - error
    RegisterSuccessResponse:
      type: object
      properties:
        message:
          type: string
          readOnly: true
          default: Successfully created account
      required:
      - message
    Reply:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        review:
          type: string
        user_name:
          type: string
          readOnly: true
        user_id:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        parent:
          type: integer
          nullable: true
      required:
      - created_at
      - id
      - review
      - user_id
      - user_name
    ResetPasswordError:
      type: object
      properties:
        error:
          type: string
          default: Incorrect OTP code or Missing info.
    ResetPasswordRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        otp:
          type: string
          description: Mã OTP 6 số nhận được từ email
        new_password:
          type: string
          description: Mật khẩu mới
          minLength: 8
      required:
      - email
      - new_password
      - otp
    ResetPasswordSuccess:
      type: object
      properties:
        message:
          type: string
          default: Password reset successful.
    ReturnSuccess:
      type: object
      properties:
        status:
          type: string
        message:
          type: string
        data:
          type: object
          additionalProperties: {}
      required:
      - data
      - message
      - status
    SellerProductNotFound:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    Shop:
      type: object
      properties:
        shop_id:
          type: integer
        shop_name:
          type: string
          maxLength: 45
        owner:
          type: integer
          readOnly: true
        shop_phone_number:
          type: string
          maxLength: 20
        shop_address:
          type: string
          maxLength: 200
        shop_email:
          type: string
          format: email
          maxLength: 254
        description:
          type: string
      required:
      - owner
      - shop_email
      - shop_id
      - shop_name
    ShopCreateError:
      type: object
      properties:
        error:
          type: string
          default: You cannot create more shops
    ShopCreateSuccess:
      type: object
      properties:
        message:
          type: string
          default: Successfully created shop
    ShopError:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    ShopNotFound:
      type: object
      properties:
        message:
          type: string
      required:
      - message
    ShopNotFoundUpdate:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    ShopOrderDetail:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        order_id:
          type: integer
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        customer_name:
          type: string
          readOnly: true
        customer_email:
          type: string
          format: email
          readOnly: true
        full_name:
          type: string
          readOnly: true
        phone_number:
          type: string
          readOnly: true
        address:
          type: string
          readOnly: true
        note:
          type: string
          readOnly: true
        product:
          type: integer
        product_name:
          type: string
          readOnly: true
        product_image:
          type: string
          description: Lấy ảnh đầu tiên của sản phẩm làm ảnh đại diện
          readOnly: true
        variant:
          type: object
          additionalProperties: {}
          readOnly: true
        quantity:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
        subtotal:
          type: number
          format: double
          readOnly: true
        order_status:
          $ref: '#/components/schemas/OrderStatusEnum'
        payment_status:
          $ref: '#/components/schemas/PaymentStatusEnum'
        payment_type:
          $ref: '#/components/schemas/PaymentTypeEnum'
      required:
      - address
      - created_at
      - customer_email
      - customer_name
      - full_name
      - id
      - note
      - order_id
      - phone_number
      - price
      - product
      - product_image
      - product_name
      - quantity
      - subtotal
      - variant
    ShopRegister:
      type: object
      properties:
        shop_name:
          type: string
          maxLength: 45
        shop_phone_number:
          type: string
          maxLength: 20
        shop_address:
          type: string
          maxLength: 200
        shop_email:
          type: string
          format: email
          maxLength: 254
        description:
          type: string
      required:
      - shop_email
      - shop_name
    ShopSystemError:
      type: object
      properties:
        message:
          type: string
        details:
          type: string
      required:
      - details
      - message
    ShopUpdateError:
      type: object
      properties:
        detail:
          type: string
      required:
      - detail
    StatusEnum:
      enum:
      - active
      - banned
      - pending
      type: string
      description: |-
        * `active` - Active
        * `banned` - Banned
        * `pending` - Pending
    TokenRefresh:
      type: object
      properties:
        access:
          type: string
          readOnly: true
        refresh:
          type: string
          writeOnly: true
      required:
      - access
      - refresh
    UpdateError:
      type: object
      properties:
        error:
          type: string
      required:
      - error
    UpdateOrderStatus:
      type: object
      properties:
        order_status:
          $ref: '#/components/schemas/OrderStatusEnum'
        payment_status:
          $ref: '#/components/schemas/PaymentStatusEnum'
    UpdateProfileError:
      type: object
      properties:
        error:
          type: string
          default: Bad Request / Update Failed
    UpdateStatusSuccess:
      type: object
      properties:
        message:
          type: string
        data:
          $ref: '#/components/schemas/UpdateOrderStatus'
      required:
      - data
      - message
    UpdateUserRequest:
      type: object
      properties:
        role:
          type: string
          description: seller
        status:
          type: string
          description: active, pending, banned
    User:
      type: object
      properties:
        user_id:
          type: integer
          readOnly: true
        user_name:
          type: string
          readOnly: true
        email:
          type: string
          format: email
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/StatusEnum'
          readOnly: true
        address:
          type: string
        phone_number:
          type: string
          nullable: true
          maxLength: 20
        role:
          type: string
          readOnly: true
        shop_name:
          type: string
          readOnly: true
        shop_phone_number:
          type: string
          readOnly: true
        shop_address:
          type: string
          readOnly: true
        shop_email:
          type: string
          readOnly: true
        shop_description:
          type: string
          readOnly: true
      required:
      - email
      - role
      - shop_address
      - shop_description
      - shop_email
      - shop_name
      - shop_phone_number
      - status
      - user_id
      - user_name
    UserNotFoundReset:
      type: object
      properties:
        error:
          type: string
          default: User does not exist.
    UserRegister:
      type: object
      properties:
        user_name:
          type: string
        email:
          type: string
          format: email
          maxLength: 254
        password:
          type: string
          writeOnly: true
          maxLength: 128
        phone_number:
          type: string
          nullable: true
      required:
      - email
      - password
      - user_name
    VNPAYQueryRequest:
      type: object
      properties:
        order_id:
          type: string
          description: Mã đơn hàng đã gửi sang VNPAY
        trans_date:
          type: string
          description: 'Thời gian tạo giao dịch (Format: YYYYMMDDHHmmss)'
      required:
      - order_id
      - trans_date
    VNPAYResponse:
      type: object
      properties:
        message:
          type: string
        order_id:
          type: integer
        payment_type:
          type: string
          default: VNPAY
        payment_url:
          type: string
          format: uri
      required:
      - message
      - order_id
      - payment_url
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
    cookieAuth:
      type: apiKey
      in: cookie
      name: sessionid
    jwtAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
